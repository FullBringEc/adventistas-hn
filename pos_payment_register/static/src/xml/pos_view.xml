<?xml version="1.0" encoding="UTF-8" ?>
<template id="template" xml:space="preserve">
    <t t-name="BtnRegisterPayment">
        <div class="control-button">Register payment</div>
    </t>
    <t t-name="BtnInvoices">
        <div class="control-button">Invoices</div>
    </t>

    <t t-name="InvoicesLineWidget">
        <div class="pos_invoice_screen screen">
            <div class="screen-content">
                <section class="top-content">
                    <span class="button back">
                        <i class="fa fa-angle-double-left"></i>
                        Cancel
                    </span>
                    <span class="searchbox">
                        <input placeholder="Search Invoice" />
                        <span class="search-clear"></span>
                    </span>
                    <span class="searchbox"></span>


                    <div style="right: 0; display: block; width: 35%; height: 100%; position: absolute;">
                        <span class="button register_payment highlight" style="left: 0;">Register <i class="fa fa-angle-double-right"></i> </span>
                        <span class="button next" id="btn_validate_payment">Validate payments <i class="fa fa-angle-double-right"></i> </span>
                    </div>
                    <!--                     <span class="button  highlight">
                        Register payment
                        <i class="fa fa-angle-double-right"></i>
                    </span> -->
                </section>
                <section class="full-content">
                    <div class="window">
                        <section class="subwindow collapsed">
                            <div class="subwindow-container collapsed">
                                <div class="subwindow-container-fix invoice-details-contents"></div>
                            </div>
                        </section>
                        <section class="subwindow">
                            <div class="subwindow-container">
                                <div class="subwindow-container-fix touch-scrollable scrollable-y">
                                    <table class="invoice-list">
                                        <thead>
                                            <tr>
                                                <th>Name</th>
                                                <th>Customer</th>
                                                <th>Journal</th>
                                                <th>Invoice date</th>
                                                <th>Due date</th>
                                                <th>Amount total</th>
                                                <th>Amount due</th>
                                                <th>Session payment</th>
                                            </tr>
                                        </thead>
                                        <tbody class="invoice-list-contents"></tbody>
                                    </table>
                                </div>
                            </div>
                        </section>
                    </div>
                </section>
            </div>
        </div>
    </t>

    <t t-name="PosInvoiceLine">
        <!-- partner_id[0] = id, partner_id[1] = name -->

        <tr class="invoice-line" t-att-data-journal-id="invoice_id.journal_id[0]" t-att-data-id="invoice_id.id" t-att-data-partner-id="invoice_id.partner_id[0]">
            <td>
                <t t-esc="invoice_id.name" />
            </td>
            <td>
                <t t-esc="invoice_id.partner_id[1]" />
            </td>
            <td>
                <t t-esc="invoice_id.journal_id[1]" />
            </td>
            <td>
                <t t-esc="invoice_id.invoice_date" />
            </td>
            <td>
                <t t-esc="invoice_id.invoice_date_due" />
            </td>
            <td>
                <t t-esc="invoice_id.amount_total" />
            </td>
            <td>
                <t t-esc="invoice_id.amount_residual" />
            </td>
            <td class="session-payment">
                <t t-esc="invoice_id.session_payment" />
            </td>
        </tr>
    </t>

    <t t-name="InvoiceDetails">
        <section class="invoice-details">
            <div class="invoice-name">
                Total: <span id="total_amount"/>
                <br/>
                Total due: <span id="total_due"/>
                <br/>
                Surcharge: <input type="number"/> $
            </div>
            <h2><t t-esc="move.name" /></h2>
            <div class="invoice-details-box clearfix">

                <!--Left dashboard-->
                <div class="invoice-details-left">
                    <div class="invoice-detail">
                        <span class="label">Amount total</span>
                        <t t-if="move.amount_total">
                            <span class="detail invoice-total">
                                <t t-esc="move.amount_total" />
                            </span>
                        </t>
                        <t t-if="!move.amount_total">
                            <span class="detail invoice-total empty">N/A</span>
                        </t>
                    </div>

                    <div class="invoice-detail">
                        <span class="label">Amount due</span>
                        <t t-if="move.amount_residual">
                            <span class="detail invoice-residual">
                                <t t-esc="move.amount_residual" />
                            </span>
                        </t>
                        <t t-if="!move.amount_residual">
                            <span class="detail invoice-residual empty">N/A</span>
                        </t>
                    </div>
                </div>

                <!-- Right dashboard -->
                <div class="invoice-details-right">
                    <div class="invoice-detail">
                        <span class="label">Invoice date</span>
                        <t t-if="move.invoice_date">
                            <span class="detail invoice-date">
                                <t t-esc="move.invoice_date" />
                            </span>
                        </t>
                        <t t-if="!move.invoice_date">
                            <span class="detail invoice-invoice_date empty">N/A</span>
                        </t>
                    </div>

                    <div class="invoice-detail">
                        <span class="label">Journal</span>
                        <t t-if="move.journal_id">
                            <span class="detail invoice-journal">
                                <t t-esc="move.journal_id[1]" />
                            </span>
                        </t>
                        <t t-if="!move.journal_id">
                            <span class="detail invoice-journal empty">N/A</span>
                        </t>
                    </div>

                </div>

                <hr />
                <h2>Payments</h2>
                <section id="payment_ids">
                    <div t-if="journal_ids" t-foreach="journal_ids" t-as="journal_id" class="payment-row" t-att-data-journal-id="journal_id.id">
                        <div class="label">
                            <t t-esc="journal_id.display_name" />
                        </div>
                        <div class="payment-text" />
                        <div class="payment-total"/>
                        <input type="number" step="0.01" t-attf-name="journal_payment_amount-{{ journal_id.id }}"
                               t-attf-id="journal_payment_amount-{{ journal_id.id }}" value="0.0" 
                               t-att-data-journal-id="journal_id.id"/>
                        <t t-set="i" t-value="0" />
                        <t t-if="journal_id.inbound_payment_method_ids" t-foreach="journal_id.inbound_payment_method_ids" t-as="payment_method_id">
                            <t t-if="i == 0">
                                <input type="radio" checked="checked" t-attf-name="payment_method_id-{{ journal_id.id }}" t-attf-id="payment_method-{{ journal_id.id }}-{{ payment_method_id }}" t-att-value="payment_method_id" />
                            </t>
                            <t t-else="">
                                <input type="radio" t-attf-name="payment_method_id-{{ journal_id.id }}" t-attf-id="payment_method-{{ journal_id.id }}-{{ payment_method_id }}" t-att-value="payment_method_id" />
                            </t>
                            <t t-set="i" t-value="1" />
                            <label t-attf-for="payment_method-{{ journal_id.id }}-{{ payment_method_id }}">
                                <t t-esc="payment_method_dict[payment_method_id].name" />
                            </label>
                        </t>
                    </div>
                </section>
            </div>
        </section>
    </t>
    <!-- con widget option podemos acceder las opciones del widget -->
    <t t-name="InvoicePaymentPopupWidget">
        <div role="dialog" class="modal-dialog">
            <div class="popup">
                <header class="title">Register Payment</header>
                <article class="container-fluid">
                    <div class="register-payment-row">
                        <div class="label">
                            <label for="journal_id">Journal:</label>
                        </div>
                        <div class="input">
                            <t t-if="widget.options.journal_ids">
                                <select id="journal_id" name="journal_id" class="invoice-select">
                                    <t t-foreach="widget.options.journal_ids" t-as="journal_id">
                                        <option t-att-value="journal_id.id" t-att-data-payment-method-ids="journal_id.inbound_payment_method_ids">
                                            <t t-esc="journal_id.display_name" />
                                        </option>
                                    </t>
                                </select>
                            </t>
                        </div>
                    </div>
                    <div class="register-payment-row">
                        <div class="label">
                            <label for="journal_id">Payment method:</label>
                        </div>
                        <div class="input">
                            <t t-if="widget.options.payment_method_ids">
                                <select id="payment_method_id" name="payment_method_id" class="invoice-select">
                                    <t t-foreach="widget.options.payment_method_ids" t-as="payment_method_id">
                                        <option t-att-value="payment_method_id.id">
                                            <t t-esc="payment_method_id.name" />
                                        </option>
                                    </t>
                                </select>
                            </t>
                        </div>
                    </div>
                    <div class="register-payment-row">
                        <div class="label">
                            <label for="amount">Amount:</label>
                        </div>
                        <div class="input">
                            <input id="amount" type="number" name="amount" />
                        </div>
                    </div>
                </article>
                <footer class="footer">
                    <div class="button cancel">
                        Cancel
                    </div>
                    <div class="button confirm">
                        Confirm
                    </div>
                </footer>
            </div>
        </div>
    </t>

</template>